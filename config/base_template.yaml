# Base Configuration Template for ASL Ablation Studies

training:
  model_class_name: "SpatialASLNet"
  dropout_rate: 0.1
  weight_decay: 0.0001
  learning_rate: 0.00005
  mse_weight: 50.0
  dc_weight: 0.0  # Data Consistency Weight for spatial models
  log_var_reg_lambda: 0.05
  log_var_cbf_min: -3.0
  log_var_cbf_max: 7.0
  log_var_att_min: -3.0
  log_var_att_max: 14.0
  batch_size: 128
  n_ensembles: 3
  n_epochs: 100
  validation_steps_per_epoch: 25
  early_stopping_patience: 20
  early_stopping_min_delta: 0.0
  norm_type: "batch"
  encoder_type: "physics_processor"
  hidden_sizes: [256, 128, 64]
  transformer_d_model_focused: 32
  transformer_nhead_model: 4
  transformer_nlayers_model: 2

fine_tuning:
  enabled: true
  encoder_lr_factor: 20.0

data:
  use_offline_dataset: true
  offline_dataset_path: "asl_spatial_dataset_100k"
  num_samples_to_load: 5000000
  pld_values: [500, 1000, 1500, 2000, 2500, 3000]
  active_features: ["mean", "std"]
  data_noise_components: ["thermal"]

  # ===== NEW: Noise and Normalization Options =====
  # noise_type: Type of thermal noise to apply
  #   - 'gaussian': Standard Gaussian additive noise (default, legacy)
  #   - 'rician': Rician noise - correct MRI physics for magnitude images
  #               Creates positive bias at low SNR, matching real MRI data
  noise_type: "gaussian"

  # normalization_mode: How to normalize input signals
  #   - 'per_curve': Z-score normalize each curve individually (default)
  #                  Creates SNR-invariant "shape vectors"
  #   - 'global_scale': Multiply all signals by global_scale_factor
  #                     Preserves absolute magnitude info (like IVIM-NET's S(b)/S(b=0))
  normalization_mode: "per_curve"

  # global_scale_factor: Scale factor for 'global_scale' mode
  #   Typical ASL signals are ~0.01-0.1, so factor of 10 gives ~0.1-1.0 range
  global_scale_factor: 10.0

simulation:
  T1_artery: 1650.0  # 3T consensus (Alsop 2015)
  T_tau: 1800.0
  T2_factor: 1.0
  alpha_BS1: 1.0
  alpha_PCASL: 0.85
  alpha_VSASL: 0.56

noise_config:
  snr_range: [1.0, 15.0]
  physio_amp_range: [0.05, 0.15]
  physio_freq_range: [0.5, 2.0]
  drift_range: [-0.02, 0.02]
  spike_probability: 0.05
  spike_magnitude_range: [2.0, 5.0]

wandb:
  wandb_project: "asl-ablation-study"
  wandb_entity: "adikondepudi"
