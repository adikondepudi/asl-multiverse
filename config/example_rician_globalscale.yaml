# FILE: config/example_rician_globalscale.yaml
# Example configuration demonstrating Rician noise and global scaling normalization.
# Based on recommendations from IVIM literature for more realistic MRI simulation.
#
# Key differences from default:
# - noise_type: 'rician' - Uses correct MRI physics (magnitude of complex signal)
# - normalization_mode: 'global_scale' - Preserves absolute magnitude info
#
# This configuration is recommended for:
# - Training models intended for in-vivo data
# - Matching IVIM-NET style preprocessing
# - Better handling of low-SNR regimes

training:
  model_class_name: "DisentangledASLNet"
  encoder_type: "physics_processor"
  hidden_sizes: [512, 256, 128]
  dropout_rate: 0.08
  weight_decay: 0.00001
  learning_rate: 0.0001
  batch_size: 8192
  n_ensembles: 5
  validation_steps_per_epoch: 10
  norm_type: "batch"
  n_epochs: 50

  log_var_cbf_min: -5.0
  log_var_cbf_max: 7.0
  log_var_att_min: -5.0
  log_var_att_max: 14.0

  transformer_d_model_focused: 32
  transformer_nhead_model: 4
  transformer_nlayers_model: 2

data:
  use_offline_dataset: true
  offline_dataset_path: "asl_offline_dataset_10M_v3"
  pld_values: [500, 1000, 1500, 2000, 2500, 3000]
  num_samples: 1000000
  active_features: ["mean", "std", "peak", "t1_artery"]
  data_noise_components: ["thermal"]

  # ===== RICIAN NOISE + GLOBAL SCALING =====
  # Rician noise: correct MRI physics for magnitude images
  # At low SNR, creates positive bias matching real MRI data
  noise_type: "rician"

  # Global scaling: multiply signals to get ~0-1 range
  # Preserves relative magnitudes between curves (like IVIM-NET)
  normalization_mode: "global_scale"

  # Typical ASL signals are ~0.01-0.1, so factor of 10 gives ~0.1-1.0
  global_scale_factor: 10.0

simulation:
  T1_artery: 1650.0  # 3T consensus (Alsop 2015)
  T_tau: 1800.0
  T2_factor: 1.0
  alpha_BS1: 1.0
  alpha_PCASL: 0.85
  alpha_VSASL: 0.56

noise_config:
  # SNR range should match expected in-vivo SNR
  # Bertleff et al. found training SNR should match test data SNR
  snr_range: [3.0, 15.0]
  physio_amp_range: [0.05, 0.15]
  drift_range: [-0.02, 0.02]
  spike_probability: 0.05
  spike_magnitude_range: [2.0, 5.0]

wandb:
  wandb_project: "asl-multiverse-rician-experiment"
  wandb_entity: "adikondepudi"
